{"version":3,"sources":["../source/InputBasic.js"],"names":["createInput","PureComponent","Component","defaultMetadata","InputBasic","state","onChange","event","props","value","newValue","target","format","indexOf","slice","setState","onBlur","_event","stopPropagation","preventDefault","focus","input","storeInput","ref","country","metadata","onFocus","rest","propTypes","string","isRequired","func","object","defaultProps"],"mappings":"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","file":"InputBasic.js","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport { parseIncompletePhoneNumber, formatIncompletePhoneNumber } from 'libphonenumber-js/core'\nimport { polyfill as reactLifecyclesCompat } from 'react-lifecycles-compat'\n\n// `PureComponent` is only available in React >= 15.3.0.\nconst PureComponent = React.PureComponent || React.Component\n\nexport function createInput(defaultMetadata)\n{\n\t/**\n\t * `InputBasic`'s caret is not as \"smart\" as the default `inputComponent`'s\n\t * but still works good enough. When erasing or inserting digits in the middle\n\t * of a phone number the caret usually jumps to the end: this is the expected\n\t * behaviour and it's the workaround for the [Samsung Galaxy smart caret positioning bug](https://github.com/catamphetamine/react-phone-number-input/issues/75).\n\t */\n\tclass InputBasic extends PureComponent\n\t{\n\t\tstatic propTypes =\n\t\t{\n\t\t\t// The parsed phone number.\n\t\t\t// E.g.: `\"\"`, `\"+\"`, `\"+123\"`, `\"123\"`.\n\t\t\tvalue : PropTypes.string.isRequired,\n\n\t\t\t// Updates the `value`.\n\t\t\tonChange : PropTypes.func.isRequired,\n\n\t\t\t// Toggles the `--focus` CSS class.\n\t\t\t// https://github.com/catamphetamine/react-phone-number-input/issues/189\n\t\t\tonFocus : PropTypes.func,\n\n\t\t\t// `onBlur` workaround for `redux-form`'s bug.\n\t\t\tonBlur : PropTypes.func,\n\n\t\t\t// A two-letter country code for formatting `value`\n\t\t\t// as a national phone number (e.g. `(800) 555 35 35`).\n\t\t\t// E.g. \"US\", \"RU\", etc.\n\t\t\t// If no `country` is passed then `value`\n\t\t\t// is formatted as an international phone number.\n\t\t\t// (e.g. `+7 800 555 35 35`)\n\t\t\tcountry : PropTypes.string,\n\n\t\t\t// `libphonenumber-js` metadata.\n\t\t\tmetadata : PropTypes.object.isRequired\n\t\t}\n\n\t\tstatic defaultProps =\n\t\t{\n\t\t\tmetadata : defaultMetadata\n\t\t}\n\n\t\t// Prevents React from resetting the `<input/>` caret position.\n\t\t// https://github.com/reactjs/react-redux/issues/525#issuecomment-254852039\n\t\t// https://github.com/facebook/react/issues/955\n\t\tstatic getDerivedStateFromProps({ value })\n\t\t{\n\t\t\treturn { value }\n\t\t}\n\n\t\tstate = {}\n\n\t\tonChange = (event) =>\n\t\t{\n\t\t\tconst { onChange } = this.props\n\t\t\tconst { value } = this.state\n\n\t\t\tlet newValue = parseIncompletePhoneNumber(event.target.value)\n\n\t\t\t// By default, if a value is something like `\"(123)\"`\n\t\t\t// then Backspace would only erase the rightmost brace\n\t\t\t// becoming something like `\"(123\"`\n\t\t\t// which would give the same `\"123\"` value\n\t\t\t// which would then be formatted back to `\"(123)\"`\n\t\t\t// and so a user wouldn't be able to erase the phone number.\n\t\t\t// Working around this issue with this simple hack.\n\t\t\tif (newValue === value)\n\t\t\t{\n\t\t\t\tif (this.format(newValue).indexOf(event.target.value) === 0)\n\t\t\t\t{\n\t\t\t\t\t// Trim the last digit (or plus sign).\n\t\t\t\t\tnewValue = newValue.slice(0, -1)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Prevents React from resetting the `<input/>` caret position.\n\t\t\t// https://github.com/reactjs/react-redux/issues/525#issuecomment-254852039\n\t\t\t// https://github.com/facebook/react/issues/955\n\t\t\tthis.setState({ value: newValue }, () => onChange(newValue))\n\t\t}\n\n\t\t// This `onBlur` interceptor is a workaround for `redux-form`'s bug\n\t\t// so that it gets the up-to-date `value` in its `onBlur` handler.\n\t\t// Without this fix it just gets the actual (raw) input field textual value.\n\t\t// E.g. `+7 800 555 35 35` instead of `+78005553535`.\n\t\t//\n\t\t// New `value` is taken from `event` in `redux-form`'s `handleBlur()`.\n\t\t// https://github.com/erikras/redux-form/blob/785edf8aac3adc84aba2ab6898a4aa8c48687750/src/ConnectedField.js#L168\n\t\t// `redux-form` shouldn't have taken the new `value` from `event`.\n\t\t//\n\t\t// A developer is not supposed to pass this `onBlur` property manually.\n\t\t// Instead, `redux-form` passes `onBlur` to this component automatically\n\t\t// and this component patches that `onBlur` handler (a hacky way but works).\n\t\t//\n\t\tonBlur = (event) =>\n\t\t{\n\t\t\tconst { onBlur } = this.props\n\t\t\tconst { value } = this.state\n\n\t\t\tif (onBlur)\n\t\t\t{\n\t\t\t\t// `event` is React's `SyntheticEvent`.\n\t\t\t\t// Its `.value` is read-only therefore cloning it.\n\t\t\t\tconst _event =\n\t\t\t\t{\n\t\t\t\t\t...event,\n\t\t\t\t\ttarget:\n\t\t\t\t\t{\n\t\t\t\t\t\t...event.target,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Workaround for `redux-form` event detection.\n\t\t\t\t// https://github.com/erikras/redux-form/blob/v5/src/events/isEvent.js\n\t\t\t\t_event.stopPropagation = event.stopPropagation\n\t\t\t\t_event.preventDefault  = event.preventDefault\n\n\t\t\t\treturn onBlur(_event)\n\t\t\t}\n\t\t}\n\n\t\tformat(value)\n\t\t{\n\t\t\tconst { country, metadata } = this.props\n\n\t\t\treturn formatIncompletePhoneNumber(value, country, metadata)\n\t\t}\n\n\t\tfocus = () => this.input.focus()\n\n\t\tstoreInput = (ref) => this.input = ref\n\n\t\trender()\n\t\t{\n\t\t\tconst\n\t\t\t{\n\t\t\t\tonChange,\n\t\t\t\tonFocus,\n\t\t\t\tcountry,\n\t\t\t\tmetadata,\n\t\t\t\t...rest\n\t\t\t}\n\t\t\t= this.props\n\n\t\t\t// Prevents React from resetting the `<input/>` caret position.\n\t\t\t// https://github.com/reactjs/react-redux/issues/525#issuecomment-254852039\n\t\t\t// https://github.com/facebook/react/issues/955\n\t\t\tconst { value } = this.state\n\n\t\t\treturn (\n\t\t\t\t<input\n\t\t\t\t\ttype=\"tel\"\n\t\t\t\t\tautoComplete=\"tel\"\n\t\t\t\t\t{...rest}\n\t\t\t\t\tref={this.storeInput}\n\t\t\t\t\tvalue={this.format(value)}\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonFocus={onFocus}\n\t\t\t\t\tonBlur={this.onBlur}/>\n\t\t\t)\n\t\t}\n\t}\n\n\treturn reactLifecyclesCompat(InputBasic)\n}\n\nexport default createInput()"]}